/* --- Custom Fixes & Overrides --- */

/*
 * Set a consistent size for all images within a wikitable.
 */
.wikitable img {
    width: 22px;
    height: 22px;
    object-fit: contain;
    display: inline-block;
    vertical-align: middle;
    margin: 0;
}

/*
 * Force size for <figure> elements inside wikitables.
 */
.wikitable figure.mw-default-size {
    width: 22px;
    height: 22px;
    margin: 0 auto;
}

/*
 * Fix for images inside list items (<li>) that were being
 * rendered as block elements, causing incorrect text wrapping.
 */
li img.mw-file-element {
    display: inline-block !important;
    vertical-align: middle !important;
    margin: 0 !important;
}

/*
 * REGRESSION FIX: Restore the horizontal alignment rule for figures
 * that have the .mw-halign-center class.
 */
figure.mw-halign-center {
    display: block;
    width: fit-content;
    width: -moz-fit-content;
    margin: 1em auto;
    clear: both;
}

/*
 * FIX: Horizontally align standalone file figures (e.g., Frame, Thumb)
 * and style them as a unified container block, but ONLY if they have a
 * non-empty caption.
 */
figure[typeof^="mw:File"]:has(figcaption:not(:empty)) {
    display: block;
    width: fit-content;
    width: -moz-fit-content; /* Firefox compatibility */
    margin: 1em auto;
    clear: both;
    /* Container styling */
    background-color: var(--body-light);
    border: 1px solid var(--body-border);
    padding: 4px;
    box-sizing: border-box;
}

/*
 * FIX: Make the link wrapping the figure image a block element
 * so that it respects the parent's padding.
 */
figure[typeof^="mw:File"] > a {
    display: block;
}

/*
 * FIX: Target the image inside any file figure specifically.
 * - Set margin to 0 to remove the vertical gap.
 * - Set border-radius to 0 to override the global style.
 * - Width is handled by the global `max-width: 100%` in base.css
 */
figure[typeof^="mw:File"] > a > img {
    margin: 0;
    border-radius: 0;
}

/*
 * Styling for all captions within the new figure container.
 */
figure > figcaption,
.thumbcaption {
    background-color: transparent;
    border: none;
    padding: 0;
    margin: 6px 2px 2px 2px; /* Top, Right, Bottom, Left */
    box-sizing: border-box;
    text-align: left;
    font-size: 0.9em;
}

/*
 * Hide empty caption blocks to prevent rendering empty boxes.
 */
figcaption:empty {
    display: none;
}
